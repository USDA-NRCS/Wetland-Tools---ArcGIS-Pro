---
title: ""
author: ""
date: ""
output: 
  word_document:
    reference_docx: NRCS-CPA-028-WC-Template.docx
---

# CONSOLIDATED CERTIFIED WETLAND DETERMINATION LEDGER

```{r cdf, echo=FALSE}

admin <- read.xlsx(Admin_Excel_Path, sheetIndex = 1, sheetName = "Admin_Table")

tract <- admin[11]
cname <- admin[12]
caddress1 <- admin[18]
caddress2 <- admin[19]
ccity <- admin[20]
cstate <- admin[21]
czip <- admin[22]
adminstate <- admin[3]
admincounty <- admin[5]
ocounty <- admin[9]
cfarm <- admin[10]
ddate <- admin[15]
wcform <- admin[16]

canull <- is.na(admin[19])
cadd <- if (canull == TRUE){
  caddress1
} else {
  c(caddress1,caddress2)
}
stzip <- paste(cstate, czip)

taddress <- data.frame(x1 = cadd,
                 x2 = ccity,
                 x3= stzip)
taddress <- data.frame(taddress)

N <- 2  # total number of rows to preallocate--possibly an overestimate

df2a <- data.frame(txt=rep("", N), txt=rep("", N), txt=rep("", N), txt=rep("", N),  # as many cols as you need
                  stringsAsFactors=FALSE)
df2a[1, ] <- (list("1. Name:",toString(cname),"2. Location County:",toString(ocounty)))
df2a[2, ] <- (list("3. Address:",toString(taddress),"4. Admin. County:",toString(admincounty)))

cdfa <- flextable(as.data.frame(df2a))
cdfa <- delete_part(cdfa, part = "header")
cdfa <- fontsize(cdfa, size = 11)
cdfa <- font(cdfa, fontname = "Times")
cdfa <- width(cdfa, j = 1, width = 0.99)
cdfa <- width(cdfa, j = 2, width = 3.39)
cdfa <- width(cdfa, j = 3, width = 1)
cdfa <- width(cdfa, j = 4, width = 2.12)
cdfa <- height(cdfa, i = 1, height = 0.35)
cdfa <- height(cdfa, i = 2, height = 0.57)
cdfa <- theme_box(cdfa)
cdfa <- bg(cdfa, j = c("txt.1", "txt.3"), bg = "light cyan")
cdfa <- align(cdfa, align = "left", part = "body")
cdfa <- valign(cdfa, valign = "top", part = "body")
cdfa

df2b <- data.frame(txt=rep("", N), txt=rep("", N), txt=rep("", N), txt=rep("", N),  # as many cols as you need
                  stringsAsFactors=FALSE)
df2b[1, ] <- list("5. Request Form:",toString(wcform),"6. Farm Number:",toString(cfarm))
df2b[2, ] <- list("7. Request Date:",toString(format(ddate, format = "%m/%d/%Y")),"8. Tract Number:",toString(tract))

cdfb <- flextable(as.data.frame(df2b))
cdfb <- delete_part(cdfb, part = "header")
cdfb <- fontsize(cdfb, size = 11)
cdfb <- font(cdfb, fontname = "Times")
cdfb <- width(cdfb, j = 1, width = 1.54)
cdfb <- width(cdfb, j = 2, width = 2.84)
cdfb <- width(cdfb, j = 3, width = 1)
cdfb <- width(cdfb, j = 4, width = 2.12)
cdfb <- height(cdfb, i = 1, height = 0.35)
cdfb <- height(cdfb, i = 2, height = 0.57)
cdfb <- theme_box(cdfb)
cdfb <- bg(cdfb, j = c("txt.1", "txt.3"), bg = "light cyan")
cdfb <- align(cdfb, align = "left", part = "body")
cdfb <- valign(cdfb, valign = "top", part = "body")
cdfb

```

 
This is a consolidated listing of previously issued and final certified wetland determinations for which appeal rights have expired. Each certified wetland determination identifies areas in the Tract subject to the wetland conservation provisions of the 1985 Food Security Act, as amended. See the attached **Definitions of Wetland Labels and Uses** for additional information and currently authorized activities under the Act. This consolidated listing of certified wetland determinations and attached map(s) are provided for your convenience. You should refer to the original certified wetland determinations and maps for the official record which will be used to determine eligibility for USDA programs.  

```{r wcdet028, echo=FALSE}
wctable <- if(is.null(Consolidate) || is.nan(Consolidate)) {
  read.xlsx(CLU_CWD_028_Excel_Path, sheetIndex = 1, sheetName = "CLU_CWD_028")
} else {
  if(Consolidate == FALSE) {
    read.xlsx(CLU_CWD_028_Excel_Path, sheetIndex = 1, sheetName = "CLU_CWD_028")
  } else {
    read.xlsx(CLU_CWD_028_Excel_Path, sheetIndex = 1, sheetName = "CLU_CWD_028_alt")
  }
}
wctable <- wctable[ ,c(4,5,6,8,9)]
wctable <- wctable[order(as.character(wctable$clu_number)),]
wctable$SUM_acres <- round(wctable$SUM_acres, 2)
wctable$SUM_acres <- as.character(wctable$SUM_acres)
wctable$cert_date <- as.character(wctable$cert_date)

wcdf <- flextable(wctable, col_keys = c("clu_number", "wetland_label", "occur_year", "SUM_acres", "cert_date")) %>%
  set_header_labels(clu_number = "Field", wetland_label = "Label", occur_year = "Occurrence year\n(CW+YEAR)", SUM_acres = "Acreage",cert_date = "Certification \nDate")
wcdf <- bold(wcdf, part = "header")
wcdf <- fontsize(wcdf, part = "header", size = 11)
wcdf <- font(wcdf, part = "header", fontname = "Times")
wcdf <- align(wcdf, align = "left", part = "header")
wcdf <- valign(wcdf, valign = "top", part = "header")
wcdf <- fontsize(wcdf, part = "body", size = 10)
wcdf<- font(wcdf, part = "body", fontname = "Times")
wcdf <- align(wcdf, align = "left", part = "body")
wcdf <- valign(wcdf, valign = "top", part = "body")
wcdf <- width(wcdf, j = 1, width = 1.37)
wcdf <- width(wcdf, j = 2, width = 0.83)
wcdf <- width(wcdf, j = 3, width = 1.28)
wcdf <- width(wcdf, j = 4, width = 1.20)
wcdf <- width(wcdf, j = 5, width = 1.40)
wcdf <- theme_box(wcdf)
wcdf <- bg(wcdf, bg = "light cyan")
wcdf

knitr::asis_output("\n \\newline \n")

N3 <- 1  # total number of rows to preallocate--possibly an overestimate

df3 <- data.frame(txt=rep("", N3),  # as many cols as you need
                  stringsAsFactors=FALSE)
df3[1, ] <- list("")

remk <- flextable(as.data.frame(df3))
remk <- set_header_labels(remk, txt = "9. Remarks")
remk <- fontsize(remk, size = 11, part = "header")
remk <- font(remk, fontname = "Times", part = "header")
remk <- fontsize(remk, size = 11)
remk <- font(remk, fontname = "Times")
remk <- height(remk, height = 5)
remk <- width(remk, width = 7.5)
remk <- theme_box(remk)
remk <- bg(remk, bg = "light cyan")
remk
```
\newpage

```{r wetdef026, echo=FALSE}
#Definitions of Wetland Labels and Uses  
wetdef <- read.csv(file.path(Path_to_the_install_directory, "Templates","WetlandDefinition.csv"), header = TRUE, sep = ",")
deftable <- flextable(wetdef, col_keys = c("dummy", "CriteriaDetermination", "AuthorizedUses", "AuthorizedMaintenance")) %>%
  compose(j = "dummy", value = as_paragraph(as_b(Label), Name)) %>%
  set_header_labels(dummy = "Label/Name", CriteriaDetermination = "Criteria for Determination", AuthorizedUses = "Authorized Uses", AuthorizedMaintenance = "Authorized Maintenance")
deftable <- bold(deftable, part = "header")
deftable <- add_header_lines(deftable, values = "Definitions of Wetland Labels and Uses")
deftable <- fontsize(deftable, part = "header", size = 10)
deftable <- font(deftable, part = "header", fontname = "Times")
deftable <- fontsize(deftable, size = 9.25)
deftable <- font(deftable, fontname = "Times")
deftable <- align(deftable, align = "left", part = "all")
deftable <- valign(deftable, valign = "top", part = "all")
deftable <- set_table_properties(deftable, width = 1, layout = "autofit")
deftable <- theme_box(deftable)
deftable
```
\newpage
# Previously Authorized Wetland Labels  
The following wetland labels have been discontinued but may have been used on older certified wetland determinations.  
```{r wetdef, echo=FALSE}
pwetdef <- read.csv(file.path(Path_to_the_install_directory, "Templates","PreviousWetlandDefinition.csv"), header = TRUE, sep = ",")
#pdeftable <- flextable(pwetdef)
pdeftable <- flextable(pwetdef, col_keys = c("dummy", "CriteriaDetermination", "AuthorizedUses", "AuthorizedMaintenance")) %>%
  compose(j = "dummy", value = as_paragraph(as_b(Label), Name)) %>%
  set_header_labels(dummy = "Label/Name", CriteriaDetermination = "Criteria for Determination", AuthorizedUses = "Authorized Uses", AuthorizedMaintenance = "Authorized Maintenance")
pdeftable <- bold(pdeftable, part = "header")
pdeftable <- fontsize(pdeftable, part = "header", size = 10)
pdeftable <- font(pdeftable, part = "header", fontname = "Times")
pdeftable <- fontsize(pdeftable, size = 9.5)
pdeftable <- font(pdeftable, fontname = "Times")
pdeftable <- set_header_labels(pdeftable, Label_Name = "Lable/Name", CriteriaDetermination = "Criteria for Determination", AuthorizedUses = "Authorized Uses", AuthorizedMaintenance = "Authorized Maintenance")
pdeftable <- set_table_properties(pdeftable, width = 1, layout = "autofit")
pdeftable <- theme_box(pdeftable)
pdeftable
```
\newpage

## Non-Discrimination Statement  

In accordance with Federal civil rights law and U.S. Department of Agriculture (USDA) civil rights regulations and policies, the USDA, its Agencies, offices, and employees, and institutions participating in or administering USDA programs are prohibited from discriminating based on race, color, national origin, religion, sex, gender identity (including gender expression), sexual orientation, disability, age, marital status, family/parental status, income derived from a public assistance program, political beliefs, or reprisal or retaliation for prior civil rights activity, in any program or activity conducted or funded by USDA (not all bases apply to all programs). Remedies and complaint filing deadlines vary by program or incident.

Persons with disabilities who require alternative means of communication for program information (e.g., Braille, large print, audiotape, American Sign Language, etc.) should contact the responsible Agency or USDA's TARGET Center at (202) 720-2600 (voice and TTY) or contact USDA through the Federal Relay Service at (800) 877-8339. Additionally, program information may be made available in languages other than English.

To file a program discrimination complaint, complete the USDA Program Discrimination Complaint Form, AD-3027, found online at [How to File a Program Discrimination Complaint](https://www.usda.gov/oascr/how-to-file-a-program-discrimination-complaint) and at any USDA office or write a letter addressed to USDA and provide in the letter all of the information requested in the form. To request a copy of the complaint form, call (866) 632-9992. Submit your completed form or letter to USDA by: (1) mail: U.S. Department of Agriculture, Office of the Assistant Secretary for Civil Rights, 1400 Independence Avenue, SW, Washington, D.C. 20250-9410; (2) fax: (202) 690-7442; or (3) email: [program.intake@usda.gov](mailto:program.intake@usda.gov).



USDA is an equal opportunity provider, employer, and lender.